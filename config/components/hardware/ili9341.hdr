#ifndef ILI9341_HDR
#define ILI9341_HDR

#include <stdint.h>

// Display driver parameters for ILI9341 3.5" TFT display
// Note: Variables scoped within ili9341 struct to avoid global namespace conflicts

// This struct acts as a "type bundle" for the ili9341 hardware.
// It will be used as a template parameter for components that need its properties.
struct ili9341
{
    // Standardized interface members from ili9341.json
    static const int WIDTH = 320;
    static const int HEIGHT = 240;

    // Standardized color channel maximums from "bits_per_pixel": 18
    static const int MAX_RED   = 0x3F; // 6 bits
    static const int MAX_GREEN = 0x3F; // 6 bits
    static const int MAX_BLUE  = 0x3F; // 6 bits

    // Standardized nested Pixel type for RGB666
    struct Pixel
    {
        unsigned int red : 6;
        unsigned int green : 6;
        unsigned int blue : 6;

        // Default constructor
        Pixel() : red(0), green(0), blue(0) {}

        // Copy constructor
        Pixel(const Pixel& other)
        {
            red = other.red;
            green = other.green;
            blue = other.blue;
        }

        // Assignment operator
        Pixel& operator=(const Pixel& other)
        {
            red = other.red;
            green = other.green;
            blue = other.blue;
            return *this;
        }

        // Add two pixels with saturation
        Pixel operator+(const Pixel& other) const
        {
            Pixel result;
            unsigned int sum_r = red + other.red;
            result.red = (sum_r > MAX_RED) ? MAX_RED : sum_r;
            unsigned int sum_g = green + other.green;
            result.green = (sum_g > MAX_GREEN) ? MAX_GREEN : sum_g;
            unsigned int sum_b = blue + other.blue;
            result.blue = (sum_b > MAX_BLUE) ? MAX_BLUE : sum_b;
            return result;
        }
    };
};

#endif // ILI9341_HDR
