// SSD1963 TFT 800x600 Display - RGB666 (18-bit) pixel format with 6-bit padding
// Forward declaration to resolve circular dependency
struct SSD1963_Pixel;
extern SSD1963_Pixel SSD1963_InitialPixel;

struct SSD1963_Pixel {
    unsigned int red : 6;    // 6 bits for red
    unsigned int green : 6;  // 6 bits for green
    unsigned int blue : 6;   // 6 bits for blue
    unsigned int pad : 6;    // 6 bits padding to align to 24 bits (3 bytes)

    // Maximum values for each color channel (for mood calculations)
    static constexpr unsigned int maxRed = 0x3F;    // 6 bits = 63
    static constexpr unsigned int maxGreen = 0x3F;  // 6 bits = 63
    static constexpr unsigned int maxBlue = 0x3F;   // 6 bits = 63
    
    // Default constructor initializes to InitialPixel
    SSD1963_Pixel() { *this = SSD1963_InitialPixel; }
    
    // Copy constructor
    SSD1963_Pixel(const SSD1963_Pixel& other) {
        red = other.red;
        green = other.green;
        blue = other.blue;
        pad = 0;
    }
    
    // Assignment operator
    SSD1963_Pixel& operator=(const SSD1963_Pixel& other) {
        red = other.red;
        green = other.green;
        blue = other.blue;
        pad = 0;
        return *this;
    }

    // Add two pixels with saturation (overflow caps at max value per channel)
    SSD1963_Pixel operator+(const SSD1963_Pixel& other) const
    {
        SSD1963_Pixel result;
        
        // Add red channel
        unsigned int sum_r = red + other.red;
        result.red = (sum_r > maxRed) ? maxRed : sum_r;
        
        // Add green channel
        unsigned int sum_g = green + other.green;
        result.green = (sum_g > maxGreen) ? maxGreen : sum_g;
        
        // Add blue channel
        unsigned int sum_b = blue + other.blue;
        result.blue = (sum_b > maxBlue) ? maxBlue : sum_b;
        
        result.pad = 0;
        return result;
    }

    // Add-assign operator with saturation
    SSD1963_Pixel& operator+=(const SSD1963_Pixel& other)
    {
        // Add red channel
        unsigned int sum_r = red + other.red;
        red = (sum_r > maxRed) ? maxRed : sum_r;
        
        // Add green channel
        unsigned int sum_g = green + other.green;
        green = (sum_g > maxGreen) ? maxGreen : sum_g;
        
        // Add blue channel
        unsigned int sum_b = blue + other.blue;
        blue = (sum_b > maxBlue) ? maxBlue : sum_b;
        
        pad = 0;
        return *this;
    }
};
