// gc9a01 component header
// Defines data structures for GC9A01 display

#ifndef GC9A01_HDR
#define GC9A01_HDR

#include <stdint.h>

struct Pixel
{
    Pixel() 
    {}
    unsigned int red : 5;
    unsigned int green : 6;
    unsigned int blue : 5;

    // Add two pixels with saturation (overflow caps at max value per channel)
    Pixel operator+(const Pixel& other) const
    {
        Pixel result;
        
        // Add red channel (5 bits, max 0x1F = 31)
        unsigned int sum_r = red + other.red;
        result.red = (sum_r > 0x1F) ? 0x1F : sum_r;
        
        // Add green channel (6 bits, max 0x3F = 63)
        unsigned int sum_g = green + other.green;
        result.green = (sum_g > 0x3F) ? 0x3F : sum_g;
        
        // Add blue channel (5 bits, max 0x1F = 31)
        unsigned int sum_b = blue + other.blue;
        result.blue = (sum_b > 0x1F) ? 0x1F : sum_b;
        
        return result;
    }

    // Add-assign operator with saturation
    Pixel& operator+=(const Pixel& other)
    {
        // Add red channel (5 bits, max 0x1F = 31)
        unsigned int sum_r = red + other.red;
        red = (sum_r > 0x1F) ? 0x1F : sum_r;
        
        // Add green channel (6 bits, max 0x3F = 63)
        unsigned int sum_g = green + other.green;
        green = (sum_g > 0x3F) ? 0x3F : sum_g;
        
        // Add blue channel (5 bits, max 0x1F = 31)
        unsigned int sum_b = blue + other.blue;
        blue = (sum_b > 0x1F) ? 0x1F : sum_b;
        
        return *this;
    }
};

// Function declarations
uint16_t gc9a01_get_width(void);
uint16_t gc9a01_get_height(void);
uint32_t getFrameSize(void);
uint32_t getFrameRowSize(void);
uint32_t getDisplaySize(void);
esp_err_t gc9a01_init(void);
void gc9a01_act(void);

#endif // GC9A01_HDR
