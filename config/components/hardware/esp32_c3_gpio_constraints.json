{
  "relative_filename": "config/components/hardware/esp32_c3_gpio_constraints.json",
  "version": "1.0.0",
  "author": "config/author.json",
  
  "component_id": "ESP32_C3_GPIO_CONSTRAINTS",
  "component_type": "GPIO_PIN_ALLOCATION",
  "description": "GPIO pin limitations and smart allocation strategies for ESP32-C3 mini controllers",
  
  "gpio_availability": {
    "total_pins": "22_TOTAL_ON_CHIP",
    "reserved_pins": {
      "power": ["VDD", "GND", "3V3", "EN"],
      "programming": ["GPIO18_USB_D-", "GPIO19_USB_D+"],
      "crystal": ["GPIO12_32KHZ", "GPIO13_32KHZ"],
      "strapping": ["GPIO2_BOOT", "GPIO8_BOOT", "GPIO9_BOOT"]
    },
    "usable_gpio": "12_PINS_MAXIMUM",
    "realistic_gpio": "8_TO_10_PINS_PRACTICAL"
  },
  
  "pin_allocation_strategies": {
    "minimal_servo_control": {
      "description": "Direct servo control with limited GPIO",
      "max_servos": "6_TO_8_SERVOS",
      "pin_usage": {
        "GPIO0": "SERVO_1_PWM",
        "GPIO1": "SERVO_2_PWM", 
        "GPIO3": "SERVO_3_PWM",
        "GPIO4": "SERVO_4_PWM",
        "GPIO5": "SERVO_5_PWM",
        "GPIO6": "SERVO_6_PWM",
        "GPIO7": "I2C_SDA_SENSORS",
        "GPIO10": "I2C_SCL_SENSORS",
        "remaining": "2_PINS_FOR_STATUS_LED_BUTTON"
      }
    },
    
    "i2c_expansion_strategy": {
      "description": "Use I2C expansion for more servos/sensors",
      "expansion_chips": ["PCA9685_PWM_EXPANDER", "PCF8574_GPIO_EXPANDER"],
      "pin_usage": {
        "GPIO7": "I2C_SDA",
        "GPIO10": "I2C_SCL", 
        "GPIO0_to_GPIO6": "DIRECT_CRITICAL_SERVOS_7_PINS",
        "PCA9685": "16_ADDITIONAL_PWM_CHANNELS",
        "total_servos": "23_SERVOS_POSSIBLE"
      }
    },
    
    "spi_expansion_strategy": {
      "description": "Use SPI for high-speed sensor communication",
      "pin_usage": {
        "GPIO2": "SPI_MOSI",
        "GPIO4": "SPI_MISO",
        "GPIO6": "SPI_CLK",
        "GPIO5": "SPI_CS_SENSOR_1",
        "GPIO7": "SPI_CS_SENSOR_2", 
        "GPIO0_to_GPIO3": "DIRECT_PWM_SERVOS_4_PINS",
        "applications": "HIGH_SPEED_IMU_ENCODERS"
      }
    }
  },
  
  "specialized_configurations": {
    "hand_controller": {
      "description": "5-finger hand control in wrist-mounted ESP32-C3",
      "constraints": "5_SERVOS_PLUS_SENSORS",
      "solution": {
        "GPIO0_to_GPIO4": "5_FINGER_SERVOS_DIRECT_PWM",
        "GPIO7_GPIO10": "I2C_FOR_PRESSURE_SENSORS", 
        "GPIO5": "STATUS_LED",
        "GPIO6": "TACTILE_BUTTON_CALIBRATION",
        "I2C_devices": ["5x_PRESSURE_SENSORS_MULTIPLEXED", "IMU_HAND_ORIENTATION"]
      }
    },
    
    "shoulder_joint_controller": {
      "description": "3-axis shoulder control with position feedback",
      "constraints": "3_SERVOS_PLUS_ENCODERS",
      "solution": {
        "GPIO0_to_GPIO2": "3_SERVO_PWM_OUTPUTS",
        "GPIO3_to_GPIO5": "3_ENCODER_INTERRUPT_INPUTS",
        "GPIO7_GPIO10": "I2C_FOR_CURRENT_SENSORS",
        "GPIO6": "STATUS_LED", 
        "remaining": "1_PIN_SPARE"
      }
    },
    
    "foot_sensor_controller": {
      "description": "Pressure sensor array in foot with 2 ankle servos",
      "constraints": "2_SERVOS_PLUS_16_PRESSURE_SENSORS",
      "solution": {
        "GPIO0_GPIO1": "2_ANKLE_SERVO_PWM",
        "GPIO7_GPIO10": "I2C_SDA_SCL", 
        "I2C_expansion": "2x_PCF8574_FOR_16_PRESSURE_SENSORS",
        "GPIO2": "IMU_INTERRUPT_BALANCE",
        "GPIO3": "STATUS_LED",
        "remaining": "4_PINS_FUTURE_EXPANSION"
      }
    }
  },
  
  "gpio_expansion_techniques": {
    "i2c_multiplexing": {
      "chip": "PCA9685_16_CHANNEL_PWM", 
      "gpio_cost": "2_PINS_SDA_SCL",
      "expansion": "16_PWM_CHANNELS",
      "benefits": "SERVO_CONTROL_WITHOUT_GPIO_USAGE",
      "limitations": "SHARED_I2C_BUS_SPEED"
    },
    
    "shift_registers": {
      "chip": "74HC595_SERIAL_TO_PARALLEL",
      "gpio_cost": "3_PINS_DATA_CLOCK_LATCH", 
      "expansion": "8_DIGITAL_OUTPUTS_PER_CHIP",
      "cascading": "UNLIMITED_CHAINING_POSSIBLE",
      "applications": "LED_INDICATORS_RELAY_CONTROL"
    },
    
    "analog_multiplexing": {
      "chip": "CD4051_8_CHANNEL_ANALOG_MUX",
      "gpio_cost": "4_PINS_3_SELECT_1_ANALOG",
      "expansion": "8_ANALOG_INPUTS_FROM_1_ADC", 
      "applications": "MULTIPLE_PRESSURE_SENSORS_POTENTIOMETERS"
    },
    
    "i2c_gpio_expanders": {
      "chip": "PCF8574_8_BIT_I2C_GPIO",
      "gpio_cost": "2_PINS_SHARED_I2C",
      "expansion": "8_DIGITAL_IO_PER_CHIP", 
      "addressing": "8_CHIPS_ON_SAME_BUS_64_PINS_TOTAL",
      "applications": "SENSOR_ENABLE_PINS_STATUS_LEDS"
    }
  },
  
  "pin_conservation_strategies": {
    "shared_buses": {
      "i2c_sharing": "MULTIPLE_SENSORS_ON_SAME_SDA_SCL",
      "spi_sharing": "MULTIPLE_DEVICES_DIFFERENT_CS_PINS",
      "benefits": "MAXIMIZE_DEVICE_COUNT_PER_PIN"
    },
    
    "multiplexed_inputs": {
      "analog_mux": "8_SENSORS_ON_1_ADC_PIN", 
      "digital_mux": "SEQUENTIAL_READING_OF_INPUTS",
      "tradeoff": "SPEED_VS_PIN_COUNT"
    },
    
    "smart_sensor_selection": {
      "i2c_sensors": "PREFER_SENSORS_WITH_I2C_INTERFACE",
      "combo_chips": "IMU_WITH_MAGNETOMETER_TEMPERATURE",
      "digital_protocols": "AVOID_ANALOG_SENSORS_WHERE_POSSIBLE" 
    }
  },
  
  "real_world_examples": {
    "8_pin_hand_controller": {
      "available_pins": "8_GPIO_USABLE",
      "requirements": "5_SERVOS_PLUS_SENSORS",
      "allocation": {
        "pin_0_to_4": "5_FINGER_SERVOS", 
        "pin_5_6": "I2C_SDA_SCL",
        "pin_7": "STATUS_LED",
        "i2c_devices": "PRESSURE_SENSOR_ARRAY_IMU"
      },
      "result": "FUNCTIONAL_5_FINGER_HAND_CONTROLLER"
    },
    
    "10_pin_shoulder_controller": {
      "available_pins": "10_GPIO_USABLE", 
      "requirements": "3_SERVOS_3_ENCODERS_SENSORS",
      "allocation": {
        "pin_0_to_2": "3_SERVO_PWM",
        "pin_3_to_5": "3_ENCODER_INTERRUPTS",
        "pin_6_7": "I2C_SDA_SCL", 
        "pin_8": "STATUS_LED",
        "pin_9": "CALIBRATION_BUTTON"
      },
      "result": "FULL_FEEDBACK_SHOULDER_CONTROL"
    }
  },
  
  "limitations_and_workarounds": {
    "servo_count_limit": {
      "problem": "ONLY_6_TO_8_DIRECT_SERVO_CONTROL",
      "solutions": [
        "USE_PCA9685_I2C_PWM_EXPANDER", 
        "HIERARCHICAL_CONTROL_MULTIPLE_ESP32C3",
        "SMART_SERVO_SELECTION_CRITICAL_JOINTS_ONLY"
      ]
    },
    
    "sensor_input_limit": {
      "problem": "LIMITED_ANALOG_AND_DIGITAL_INPUTS",
      "solutions": [
        "I2C_SENSOR_MODULES_INSTEAD_OF_ANALOG",
        "ANALOG_MULTIPLEXERS_FOR_MULTIPLE_SENSORS", 
        "DIGITAL_SENSOR_PROTOCOLS_ONE_WIRE_I2C"
      ]
    },
    
    "communication_overhead": {
      "problem": "I2C_BUS_SHARED_BY_MANY_DEVICES", 
      "solutions": [
        "PRIORITIZE_CRITICAL_REAL_TIME_SIGNALS",
        "BATCH_SENSOR_READINGS_REDUCE_TRANSACTIONS",
        "USE_INTERRUPT_DRIVEN_I2C_NON_BLOCKING"
      ]
    }
  },
  
  "design_philosophy": {
    "principle": "SMART_ALLOCATION_OVER_BRUTE_FORCE",
    "approach": "EACH_ESP32C3_SPECIALIZED_FOR_SPECIFIC_SUBSYSTEM", 
    "benefits": [
      "DISTRIBUTED_PROCESSING_REDUCES_INDIVIDUAL_GPIO_NEEDS",
      "MESH_COMMUNICATION_ELIMINATES_LONG_WIRE_RUNS",
      "MODULAR_DESIGN_ALLOWS_INCREMENTAL_DEVELOPMENT",
      "FAILURE_ISOLATION_ONE_CONTROLLER_FAILURE_CONTAINED"
    ]
  }
}