<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Goblin Head STL Viewer - Visual Build Guide</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/STLLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: white;
            overflow-x: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            padding: 20px;
            text-align: center;
            border-bottom: 3px solid #e74c3c;
        }
        
        .header h1 {
            margin: 0;
            color: #ecf0f1;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .viewer-container {
            background: #2c3e50;
            border-radius: 10px;
            padding: 15px;
            border: 2px solid #34495e;
            position: relative;
        }
        
        .viewer-title {
            background: #e74c3c;
            color: white;
            padding: 10px;
            margin: -15px -15px 15px -15px;
            border-radius: 8px 8px 0 0;
            font-weight: bold;
            text-align: center;
        }
        
        .viewer {
            width: 100%;
            height: 400px;
            border: 2px solid #34495e;
            border-radius: 5px;
            background: #1a1a1a;
        }
        
        .specs {
            background: #34495e;
            padding: 10px;
            margin-top: 10px;
            border-radius: 5px;
            font-size: 12px;
        }
        
        .specs h4 {
            margin: 0 0 10px 0;
            color: #e74c3c;
        }
        
        .specs ul {
            margin: 5px 0;
            padding-left: 20px;
        }
        
        .wiring-section {
            grid-column: 1 / -1;
            background: #2c3e50;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid #34495e;
            margin-top: 20px;
        }
        
        .wiring-diagram {
            background: #1a1a1a;
            padding: 20px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #2ecc71;
            overflow-x: auto;
            white-space: pre;
        }
        
        .controls {
            position: absolute;
            bottom: 10px;
            right: 10px;
            font-size: 10px;
            color: #95a5a6;
        }
        
        .error {
            color: #e74c3c;
            text-align: center;
            padding: 20px;
            background: #34495e;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ¤– GOBLIN HEAD - Visual STL Component Guide</h1>
        <p>Interactive 3D models showing actual printable geometry</p>
    </div>

    <div class="container">
        <!-- Main Skull Viewer -->
        <div class="viewer-container">
            <div class="viewer-title">Main Goblin Skull (green_goblin_skull.stl)</div>
            <div id="skull-viewer" class="viewer"></div>
            <div class="specs">
                <h4>ğŸ“ Specifications:</h4>
                <ul>
                    <li><strong>File Size:</strong> 1.55 MB (7,844 faces)</li>
                    <li><strong>Eye Sockets:</strong> 32mm diameter for GC9A01 displays</li>
                    <li><strong>Mouth Opening:</strong> Large cavity for display mount</li>
                    <li><strong>Nose Mount:</strong> Integrated HC-SR04 sensor bracket</li>
                    <li><strong>Print Time:</strong> ~6-8 hours</li>
                </ul>
            </div>
            <div class="controls">Mouse: Rotate | Wheel: Zoom | Right-click: Pan</div>
        </div>

        <!-- Display Mount Viewer -->
        <div class="viewer-container">
            <div class="viewer-title">Display Mount (display_basic_mount.stl)</div>
            <div id="display-viewer" class="viewer"></div>
            <div class="specs">
                <h4>ğŸ”§ Component Details:</h4>
                <ul>
                    <li><strong>Purpose:</strong> Secure GC9A01 displays in eye/mouth sockets</li>
                    <li><strong>Mounting:</strong> 4x M2 screws on 28mm centers</li>
                    <li><strong>Fit:</strong> 32mm display diameter + 0.2mm clearance</li>
                    <li><strong>Material:</strong> PLA+ recommended</li>
                </ul>
            </div>
            <div class="controls">Mouse: Rotate | Wheel: Zoom | Right-click: Pan</div>
        </div>

        <!-- Sensor Mount Viewer -->
        <div class="viewer-container">
            <div class="viewer-title">Sensor Mount (goblin_nose_sensor.stl)</div>
            <div id="sensor-viewer" class="viewer"></div>
            <div class="specs">
                <h4>ğŸ“¡ Sensor Integration:</h4>
                <ul>
                    <li><strong>Component:</strong> HC-SR04 ultrasonic sensor</li>
                    <li><strong>Range:</strong> 2cm to 4m distance detection</li>
                    <li><strong>Mounting:</strong> Integrated nose bracket design</li>
                    <li><strong>Wiring:</strong> TRIG (GPIO 9) + ECHO (GPIO 10)</li>
                </ul>
            </div>
            <div class="controls">Mouse: Rotate | Wheel: Zoom | Right-click: Pan</div>
        </div>

        <!-- Speaker Mount Viewer -->
        <div class="viewer-container">
            <div class="viewer-title">Speaker Mount (speaker_basic_mount.stl)</div>
            <div id="speaker-viewer" class="viewer"></div>
            <div class="specs">
                <h4>ğŸ”Š Audio System:</h4>
                <ul>
                    <li><strong>Speaker Type:</strong> 40mm I2S digital speaker</li>
                    <li><strong>Power:</strong> 3-5W RMS, 200mA peak</li>
                    <li><strong>Interface:</strong> I2S (BCLK, WS, DATA)</li>
                    <li><strong>Quality:</strong> 16-bit digital audio</li>
                </ul>
            </div>
            <div class="controls">Mouse: Rotate | Wheel: Zoom | Right-click: Pan</div>
        </div>
    </div>

    <!-- Wiring Diagram Section -->
    <div class="wiring-section">
        <div class="viewer-title">ğŸ”Œ Complete Wiring Diagram</div>
        <div class="wiring-diagram">ESP32-S3-DevKitC-1 Pin Configuration

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ESP32-S3 Controller        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  ğŸ“± SPI DISPLAYS (Shared Bus)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€ â”‚
â”‚  â”‚ GPIO 12 â”‚ GPIO 13 â”‚ GPIO 14 â”‚       â”‚ â† Shared MISO/MOSI/CLK
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚       â”‚         â”‚         â”‚            â”‚
â”‚  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”¬â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”¬â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ GPIO 15 â”‚ GPIO 16 â”‚ GPIO 17 â”‚       â”‚ â† Individual CS pins
â”‚  â”‚ (L.Eye) â”‚ (R.Eye) â”‚ (Mouth) â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                         â”‚
â”‚  ğŸ”Š I2S AUDIO BUS                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ GPIO 4  â”‚ GPIO 5  â”‚ GPIO 6  â”‚       â”‚
â”‚  â”‚ (BCLK)  â”‚ (WS)    â”‚ (DATA)  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                         â”‚
â”‚  ğŸ“¡ ULTRASONIC SENSOR                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ GPIO 9  â”‚ GPIO 10 â”‚                 â”‚
â”‚  â”‚ (TRIG)  â”‚ (ECHO)  â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                         â”‚
â”‚  âš¡ POWER DISTRIBUTION                  â”‚
â”‚  5V  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ All Components â”‚
â”‚  GND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Common Ground  â”‚
â”‚  3.3V â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ESP32 Logic   â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Total GPIO Usage: 12 pins (25% of available)
Power Requirement: 5V @ 1A maximum</div>
    </div>

    <script>
        // STL file paths
        const stlFiles = {
            skull: 'assets/shapes/stl/green_goblin_skull.stl',
            display: 'assets/shapes/stl/display_basic_mount.stl', 
            sensor: 'assets/shapes/stl/goblin_nose_sensor.stl',
            speaker: 'assets/shapes/stl/speaker_basic_mount.stl'
        };

        // Create viewers for each STL file
        function createViewer(containerId, stlPath, color = 0x4CAF50) {
            const container = document.getElementById(containerId);
            
            // Scene setup
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0x1a1a1a);
            
            // Camera setup
            const camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            
            // Renderer setup
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            container.appendChild(renderer.domElement);
            
            // Lighting setup
            const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(1, 1, 1);
            directionalLight.castShadow = true;
            scene.add(directionalLight);
            
            const directionalLight2 = new THREE.DirectionalLight(0xffffff, 0.4);
            directionalLight2.position.set(-1, -1, 0.5);
            scene.add(directionalLight2);
            
            // Controls
            const controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            
            // STL Loader
            const loader = new THREE.STLLoader();
            loader.load(
                stlPath,
                function (geometry) {
                    // Material setup
                    const material = new THREE.MeshLambertMaterial({ 
                        color: color,
                        transparent: true,
                        opacity: 0.9
                    });
                    
                    // Create mesh
                    const mesh = new THREE.Mesh(geometry, material);
                    mesh.castShadow = true;
                    mesh.receiveShadow = true;
                    
                    // Center and scale geometry
                    geometry.computeBoundingBox();
                    const center = geometry.boundingBox.getCenter(new THREE.Vector3());
                    geometry.translate(-center.x, -center.y, -center.z);
                    
                    const size = geometry.boundingBox.getSize(new THREE.Vector3());
                    const maxDim = Math.max(size.x, size.y, size.z);
                    const scale = 100 / maxDim;
                    geometry.scale(scale, scale, scale);
                    
                    scene.add(mesh);
                    
                    // Position camera
                    camera.position.set(50, 50, 50);
                    camera.lookAt(0, 0, 0);
                    
                    // Animation loop
                    function animate() {
                        requestAnimationFrame(animate);
                        controls.update();
                        renderer.render(scene, camera);
                    }
                    animate();
                },
                function (progress) {
                    console.log('Loading progress:', (progress.loaded / progress.total * 100) + '%');
                },
                function (error) {
                    console.error('STL loading error:', error);
                    container.innerHTML = '<div class="error">Error loading STL file: ' + stlPath + '<br>File may not exist or be accessible.</div>';
                }
            );
            
            // Handle window resize
            window.addEventListener('resize', function() {
                camera.aspect = container.clientWidth / container.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(container.clientWidth, container.clientHeight);
            });
        }

        // Initialize all viewers when page loads
        window.addEventListener('load', function() {
            createViewer('skull-viewer', stlFiles.skull, 0x2ECC71);        // Green
            createViewer('display-viewer', stlFiles.display, 0x3498DB);    // Blue  
            createViewer('sensor-viewer', stlFiles.sensor, 0xE74C3C);      // Red
            createViewer('speaker-viewer', stlFiles.speaker, 0xF39C12);    // Orange
        });
    </script>
</body>
</html>